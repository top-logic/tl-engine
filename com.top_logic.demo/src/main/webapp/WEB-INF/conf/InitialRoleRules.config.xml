<?xml version="1.0" encoding="utf-8" ?>

<application>
	<services>
		<config service-class="com.top_logic.tool.boundsec.manager.AccessManager">
			<instance>
				<role-rules>
					<rules>
						<rule
							inherit="true"
							meta-element="tl.accounts:WithOwner"
							role="SecurityStructure.OwnerRole"
						>
							<path>
								<step
									attribute="owner"
									inverse="false"
								/>
							</path>
						</rule>

						<rule
							inherit="true"
							meta-element="DemoSecurity:DemoSecurity.A"
							role="DemoSecurity.Role1"
						>
							<path>
								<step
									attribute="singlePersonContact"
									inverse="false"
								/>
							</path>
						</rule>

						<rule
							inherit="true"
							meta-element="DemoSecurity:DemoSecurity.A"
							role="DemoSecurity.Role2"
						>
							<path>
								<step
									attribute="personContactList"
									inverse="false"
								/>
							</path>
						</rule>

						<inheritance-rule
							inherit="true"
							meta-element="DemoSecurity:DemoSecurity.A"
							role="DemoSecurity.SecurityAdministrator"
						>
							<path>
								<step
									attribute="children"
									inverse="true"
									meta-element="DemoSecurity:DemoSecurityElementContainer"
								/>
							</path>
						</inheritance-rule>

						<inheritance-rule
							base="structureRoot@DemoSecurity"
							inherit="true"
							meta-element="DemoSecurity:DemoSecurity.B"
							role="DemoSecurity.SecurityAdministratorB"
							source-role="DemoSecurity.SecurityAdministrator"
						/>

						<inheritance-rule
							inherit="true"
							meta-element="DemoSecurity:DemoSecurity.All"
							role="DemoSecurity.selection"
							source-role="DemoSecurity.Role1,DemoSecurity.Role2,DemoSecurity.Role3,DemoSecurity.SecurityAdministrator,DemoSecurity.SecurityAdministratorB,DemoSecurity.User"
						/>

						<inheritance-rule
							inherit="true"
							meta-element="DemoSecurity:DemoSecurity.All"
							role="DemoSecurity.navigation"
							source-role="DemoSecurity.selection"
						/>

						<inheritance-rule
							inherit="true"
							meta-element="DemoSecurity:DemoSecurityElementContainer"
							role="DemoSecurity.navigation"
						>
							<path>
								<step
									attribute="children"
									inverse="false"
								/>
							</path>
						</inheritance-rule>

						<inheritance-rule
							inherit="true"
							meta-element="DemoTypes:DemoTypes.All"
							role="DemoTypes.Navigation"
							source-role="DemoTypes.Selection"
						/>

						<inheritance-rule
							inherit="true"
							meta-element="DemoTypes:DemoTypesContainer"
							role="DemoTypes.Navigation"
						>
							<path>
								<step
									attribute="children"
									inverse="false"
								/>
							</path>
						</inheritance-rule>

						<inheritance-rule
							inherit="true"
							meta-element="DemoTypes:DemoTypes.All"
							role="DemoTypes.Administrator"
						>
							<path>
								<step
									attribute="children"
									inverse="true"
									meta-element="DemoTypes:DemoTypesContainer"
								/>
							</path>
						</inheritance-rule>

						<inheritance-rule
							inherit="true"
							meta-element="DemoTypes:DemoTypes.All"
							role="DemoTypes.StringAdministrator"
						>
							<path>
								<step
									attribute="children"
									inverse="true"
									meta-element="DemoTypes:DemoTypesContainer"
								/>
							</path>
						</inheritance-rule>

						<inheritance-rule
							inherit="true"
							meta-element="DemoTypes:DemoTypes.All"
							role="DemoTypes.BooleanAdministrator"
						>
							<path>
								<step
									attribute="children"
									inverse="true"
									meta-element="DemoTypes:DemoTypesContainer"
								/>
							</path>
						</inheritance-rule>

						<inheritance-rule
							inherit="true"
							meta-element="DemoTypes:DemoTypes.All"
							role="DemoTypes.DateAdministrator"
						>
							<path>
								<step
									attribute="children"
									inverse="true"
									meta-element="DemoTypes:DemoTypesContainer"
								/>
							</path>
						</inheritance-rule>

						<inheritance-rule
							inherit="true"
							meta-element="DemoTypes:DemoTypes.All"
							role="DemoTypes.Selection"
							source-role="DemoTypes.Administrator,DemoTypes.Responsible,DemoTypes.BAdministrator,DemoTypes.BooleanAdministrator,DemoTypes.DateAdministrator,DemoTypes.StringAdministrator"
						/>

						<rule
							inherit="true"
							meta-element="DemoTypes:DemoTypes.A"
							role="DemoTypes.Responsible"
						>
							<path>
								<step
									attribute="responsible"
									meta-element="DemoTypes:DemoTypes.A"
								/>
							</path>
						</rule>
						<rule
							inherit="true"
							meta-element="DemoTypes:DemoTypes.A"
							role="DemoTypes.Responsible"
						>
							<path>
								<step
									attribute="responsibleContact"
									meta-element="DemoTypes:DemoTypes.A"
								/>
								<step
									attribute="contact"
									inverse="true"
									meta-element="tl.accounts:Person"
								/>
							</path>
						</rule>
						<inheritance-rule
							inherit="true"
							meta-element="DemoTypes:DemoTypes.All"
							role="DemoTypes.Responsible"
						>
							<path>
								<step
									attribute="children"
									inverse="true"
									meta-element="DemoTypes:DemoTypesContainer"
								/>
							</path>
						</inheritance-rule>

						<inheritance-rule
							base="structureRoot@DemoTypes"
							inherit="true"
							meta-element="DemoTypes:DemoTypes.B"
							role="DemoTypes.BAdministrator"
						/>
					</rules>
				</role-rules>
			</instance>
		</config>
	</services>
</application>