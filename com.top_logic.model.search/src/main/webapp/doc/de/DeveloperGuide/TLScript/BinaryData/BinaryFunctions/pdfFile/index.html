<h2>Syntax</h2>

<pre>
	<code>pdfFile(html: $htmlContent, name: $filename, pageWidth: $width, pageHeight: $height,
          resolution: $dpi, marginLeft: $ml, marginRight: $mr, marginTop: $mt, marginBottom: $mb)</code>
</pre>

<h2>Beschreibung</h2>

<p>Konvertiert HTML-Inhalte in ein PDF-Dokument. Das HTML wird als PDF gerendert, wobei die Flying Saucer-Bibliothek verwendet wird, die hochwertige PDF-Ausgaben aus wohlgeformtem XHTML erzeugt.</p>

<p>Diese Funktion akzeptiert drei Arten von Eingaben:</p>
<ul>
	<li><strong>String:</strong> Einfaches HTML als mehrzeiliges String-Literal (mit dreifachen Anführungszeichen <code>"""..."""</code>)</li>
	<li><strong>HTMLFragment:</strong> HTML mit eingebetteten TLScript-Ausdrücken (mit HTML-Literal-Syntax mit dreifachen geschweiften Klammern <code>{{{...}}}</code>)</li>
	<li><strong>BinaryDataSource:</strong> Binärdaten mit Content-Type <code>text/html</code> oder <code>text/plain</code>, die HTML-Markup enthalten</li>
</ul>

<p>Diese Funktion ist besonders nützlich für die Erstellung von Berichten, Rechnungen oder anderen Dokumenten, die dynamisch aus HTML-Vorlagen generiert und als PDF exportiert werden müssen.</p>

<p><strong>Wichtig:</strong> Das HTML muss wohlgeformtes XHTML sein. Alle Tags müssen ordnungsgemäß geschlossen werden, und selbstschließende Tags sollten die XHTML-Syntax verwenden (z.B. <code>&lt;br/&gt;</code> statt <code>&lt;br&gt;</code>).</p>

<h2>Parameter</h2>

<table class="tlDocTable">
	<thead>
		<tr>
			<th>Bezeichnung</th>
			<th>Typ</th>
			<th>Beschreibung</th>
			<th>Pflicht</th>
			<th>Standard</th>
		</tr>
		<tr>
			<td>html</td>
			<td>String, HTMLFragment oder BinaryDataSource</td>
			<td>Der HTML-Inhalt, der in PDF konvertiert werden soll. Kann ein einfacher String (mit dreifachen Anführungszeichen <code>"""..."""</code>), ein HTMLFragment (mit dreifachen geschweiften Klammern <code>{{{...}}}</code> Syntax mit eingebetteten TLScript-Ausdrücken) oder eine BinaryDataSource mit Content-Type <code>text/html</code> oder <code>text/plain</code> sein. Muss wohlgeformtes XHTML sein, bei dem alle Tags ordnungsgemäß geschlossen sind.</td>
			<td>ja</td>
			<td> </td>
		</tr>
		<tr>
			<td>name</td>
			<td>String</td>
			<td>Der Dateiname für das generierte PDF. Die Erweiterung .pdf wird automatisch hinzugefügt, falls nicht vorhanden.</td>
			<td>nein</td>
			<td>document.pdf</td>
		</tr>
		<tr>
			<td>pageWidth</td>
			<td>Number</td>
			<td>Die Seitenbreite in Pixeln.</td>
			<td>nein</td>
			<td>1240 (A4-Breite bei 150 DPI)</td>
		</tr>
		<tr>
			<td>pageHeight</td>
			<td>Number</td>
			<td>Die Seitenhöhe in Pixeln.</td>
			<td>nein</td>
			<td>1754 (A4-Höhe bei 150 DPI)</td>
		</tr>
		<tr>
			<td>resolution</td>
			<td>Number</td>
			<td>Die Rendering-Auflösung in DPI (Punkte pro Zoll). Höhere Werte erzeugen bessere Qualität, aber größere Dateien.</td>
			<td>nein</td>
			<td>150</td>
		</tr>
		<tr>
			<td>marginLeft</td>
			<td>Number</td>
			<td>Der linke Rand in Pixeln.</td>
			<td>nein</td>
			<td>88 (15mm bei 150 DPI)</td>
		</tr>
		<tr>
			<td>marginRight</td>
			<td>Number</td>
			<td>Der rechte Rand in Pixeln.</td>
			<td>nein</td>
			<td>88 (15mm bei 150 DPI)</td>
		</tr>
		<tr>
			<td>marginTop</td>
			<td>Number</td>
			<td>Der obere Rand in Pixeln.</td>
			<td>nein</td>
			<td>88 (15mm bei 150 DPI)</td>
		</tr>
		<tr>
			<td>marginBottom</td>
			<td>Number</td>
			<td>Der untere Rand in Pixeln.</td>
			<td>nein</td>
			<td>59 (10mm bei 150 DPI)</td>
		</tr>
	</thead>
</table>

<h2> </h2>

<h2>Rückgabewert</h2>

<p><strong>Typ:</strong> BinaryData</p>

<p>Gibt ein Binärdaten-Objekt zurück, das das generierte PDF mit dem Content-Type <code>application/pdf</code> enthält. Gibt <code>null</code> zurück, wenn die HTML-Eingabe null oder leer ist.</p>

<p>Wenn die PDF-Generierung fehlschlägt, wird eine <code>RuntimeException</code> mit Details zum Fehler ausgelöst.</p>

<h2>Beispiele</h2>

<h3>Einfaches PDF mit String-Literal</h3>

<pre>
	<code>pdfFile("""
  &lt;html&gt;
    &lt;body&gt;
      &lt;h1&gt;Hallo Welt&lt;/h1&gt;
      &lt;p&gt;Dies ist ein aus HTML generiertes PDF.&lt;/p&gt;
    &lt;/body&gt;
  &lt;/html&gt;
""")</code>
</pre>

<p><strong>Ausgabe:</strong> Ein PDF-Dokument mit dem Namen "document.pdf", das "Hallo Welt" als Überschrift und einen Textabsatz enthält.</p>

<h3>PDF mit HTMLFragment und dynamischem Inhalt</h3>

<pre>
	<code>pdfFile({{{
  &lt;html&gt;
    &lt;body&gt;
      &lt;h1&gt;Rechnung für ${$customer.get('name')}&lt;/h1&gt;
      &lt;p&gt;Datum: ${format(now(), 'yyyy-MM-dd')}&lt;/p&gt;
      &lt;p&gt;Betrag: ${$invoice.get('amount')}&lt;/p&gt;
    &lt;/body&gt;
  &lt;/html&gt;
}}}, "rechnung-" + $invoice.get('number'))</code>
</pre>

<p><strong>Ausgabe:</strong> Ein PDF mit dynamisch generiertem Inhalt. Die <code>{{{...}}}</code> Syntax ermöglicht das Einbetten von TLScript-Ausdrücken direkt im HTML, die vor der PDF-Generierung ausgewertet und sicher HTML-kodiert werden.</p>

<h3>PDF mit benutzerdefiniertem Dateinamen</h3>

<pre>
	<code>pdfFile("""
  &lt;html&gt;
    &lt;body&gt;
      &lt;h1&gt;Rechnung&lt;/h1&gt;
      &lt;p&gt;Rechnung #12345&lt;/p&gt;
    &lt;/body&gt;
  &lt;/html&gt;
""", "rechnung-12345")</code>
</pre>

<p><strong>Ausgabe:</strong> Ein PDF-Dokument mit dem Namen "rechnung-12345.pdf". Die Erweiterung .pdf wird automatisch hinzugefügt.</p>

<h3>Gestalteter Bericht mit dynamischem Dateinamen</h3>

<pre>
	<code>pdfFile({{{
  &lt;html&gt;
    &lt;head&gt;
      &lt;style&gt;
        body { font-family: Arial, sans-serif; }
        h1 { color: #333366; }
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #ddd; padding: 8px; }
        th { background-color: #4CAF50; color: white; }
      &lt;/style&gt;
    &lt;/head&gt;
    &lt;body&gt;
      &lt;h1&gt;Verkaufsbericht&lt;/h1&gt;
      &lt;p&gt;Erstellt am: ${format(now(), 'yyyy-MM-dd')}&lt;/p&gt;
      &lt;table&gt;
        &lt;tr&gt;
          &lt;th&gt;Produkt&lt;/th&gt;
          &lt;th&gt;Menge&lt;/th&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;Widget A&lt;/td&gt;
          &lt;td&gt;150&lt;/td&gt;
        &lt;/tr&gt;
      &lt;/table&gt;
    &lt;/body&gt;
  &lt;/html&gt;
}}}, "verkaufsbericht-" + format(now(), 'yyyy-MM-dd'))</code>
</pre>

<p><strong>Ausgabe:</strong> Ein gestalteter PDF-Bericht mit dem Namen "verkaufsbericht-2025-10-22.pdf", einschließlich Tabelle, eingebetteter CSS-Stile und dynamischem Datum.</p>

<h3>Dynamischer Inhalt mit Iteration</h3>

<pre>
	<code>pdfFile({{{
  &lt;html&gt;
    &lt;body&gt;
      &lt;h1&gt;Rechnungspositionen&lt;/h1&gt;
      &lt;ul&gt;
        ${$items.map(item -> {{{
          &lt;li&gt;${item.get('name')} - ${item.get('price')}&lt;/li&gt;
        }}})}
      &lt;/ul&gt;
    &lt;/body&gt;
  &lt;/html&gt;
}}})</code>
</pre>

<p><strong>Ausgabe:</strong> Ein PDF mit einer dynamisch generierten Liste von Rechnungspositionen.</p>

<h3>Benutzerdefinierte Seitengröße und Auflösung</h3>

<pre>
	<code>// US Letter-Format bei 200 DPI mit benutzerdefinierten Rändern
pdfFile("""
  &lt;html&gt;
    &lt;body&gt;
      &lt;h1&gt;Hochqualitativer Bericht&lt;/h1&gt;
      &lt;p&gt;Dieses Dokument wird mit höherer Auflösung gerendert.&lt;/p&gt;
    &lt;/body&gt;
  &lt;/html&gt;
""", "bericht.pdf", 1700, 2200, 200, 100, 100, 100, 100)</code>
</pre>

<p><strong>Ausgabe:</strong> Ein PDF mit US Letter-Seitengröße (8,5" x 11" = 1700x2200 px bei 200 DPI) und 100-Pixel-Rändern auf allen Seiten.</p>

<h3>Minimale Ränder für maximalen Inhalt</h3>

<pre>
	<code>// A4 mit minimalen Rändern
pdfFile({{{
  &lt;html&gt;
    &lt;body&gt;
      &lt;h1&gt;Ganzseitiger Inhalt&lt;/h1&gt;
      &lt;p&gt;Dies verwendet minimale Ränder, um den Inhaltsbereich zu maximieren.&lt;/p&gt;
    &lt;/body&gt;
  &lt;/html&gt;
}}}, "vollseite.pdf", 1240, 1754, 150, 20, 20, 20, 20)</code>
</pre>

<p><strong>Ausgabe:</strong> Ein PDF mit A4-Seitengröße und minimalen 20-Pixel-Rändern (ca. 3,4mm bei 150 DPI).</p>

<h2>Technische Hinweise</h2>

<ul>
	<li><strong>Standardeinstellungen:</strong> Standard-Seitengröße ist A4 (1240x1754 Pixel bei 150 DPI = 210mm x 297mm)</li>
	<li><strong>Auflösung:</strong> Standardauflösung ist 150 DPI, geeignet für die meisten Druck- und Bildschirmansichten. Höhere Werte (z.B. 300 DPI) erzeugen bessere Qualität, aber größere Dateien</li>
	<li><strong>Ränder:</strong> Standardränder sind 15mm (links, rechts, oben) und 10mm (unten). Ränder werden in Pixeln bei der gewählten Auflösung angegeben</li>
	<li><strong>Seitengrößenberechnungen:</strong>
		<ul>
			<li>A4 bei 150 DPI: 1240 x 1754 Pixel</li>
			<li>US Letter bei 150 DPI: 1275 x 1650 Pixel</li>
			<li>A4 bei 300 DPI: 2480 x 3508 Pixel</li>
			<li>Formel: Pixel = (Millimeter / 25,4) × DPI</li>
		</ul>
	</li>
	<li><strong>CSS-Unterstützung:</strong> Grundlegende CSS2-Stile werden unterstützt. Komplexe CSS3-Features werden möglicherweise nicht korrekt gerendert</li>
	<li><strong>Bilder:</strong> Externe Bilder benötigen zugängliche URLs. Base64-kodierte Bilder werden unterstützt</li>
	<li><strong>Schriftarten:</strong> Standardschriftarten sind verfügbar. Benutzerdefinierte Schriftarten erfordern möglicherweise zusätzliche Konfiguration</li>
	<li><strong>Parameterreihenfolge:</strong> Alle Parameter nach <code>html</code> sind optional und positionsabhängig. Um einen späteren Parameter anzugeben, müssen Werte (oder null) für alle früheren Parameter angegeben werden</li>
</ul>
