<p>In diesem Kapitel wird <strong>JMX </strong>(<strong>J</strong>ava <strong>M</strong>anagement E<strong>x</strong>tensions) zur Überwachung und Verwaltung einer Applikation vorgestellt. Ein <strong>JMX Agent</strong> besteht aus einem <strong>MBean Server</strong> und weiteren Möglichkeiten zur Verwaltung von <strong>MBeans</strong> (<strong>M</strong>anaged <strong>Beans</strong>). Diese MBeans bilden die Schnittstelle zur Anwendung. Sie können Daten bereitstellen, aber auch Aufgaben ausführen. Z. B. über eine <strong><a class="tlObject" href="?page=jconsole&amp;uuid=9b52cdad-0354-4d79-82a2-9b1cf0339279">JConsole</a> </strong>(<strong>J</strong>ava Monitoring and Management <strong>Console</strong>) können die am MBean Server registrierten MBeans angesehen und ihre Operationen ausgeführt werden. Die entstandenen Daten können über z. B. <strong><a class="tlObject" href="?page=prometheus&amp;uuid=860d38f9-6099-48bc-9073-265541d12e57">Prometheus</a> </strong>gesammelt und einfach graphisch angezeigt werden. Durch z. B. <strong><a class="tlObject" href="?page=grafana&amp;uuid=42d01f7d-d71f-401f-8817-dc253efb0aa9">Grafana</a> </strong>können diese gesammelten Daten noch weiter aufbereitet werden.</p>

<p> </p>

<p style="text-align:center"><img src="ref:fig1_29760.gif" style="opacity:1" /></p>

<p style="text-align:center"><em>Bild 1: JMX Tiered Architecture<sup>1</sup></em></p>

<h2>MBeans</h2>

<p>MBeans sind Java-Objekte, die Ressourcen und Anwendungsverwaltungsfunktionen in der JMX Technologie repräsentieren. Sie ermöglichen die Beobachtung und Steuerung von Systemressourcen, wie etwa den Speicherverbrauch, Thread-Management und benutzerdefinierte Metriken in Java-Anwendungungen. Durch MBeans gelangt man unter anderem an folgende Informationen:</p>

<ul>
	<li>Exakte Java Version</li>
	<li>Argumente für die JVM, Classpath, Library Path,...</li>
	<li>Detaillierte Speicher-Verwendung der JVM</li>
	<li>Detaillierte Speicher- und CPU-Auslastung des Betriebssystems</li>
	<li>Detaillierte Auflistung der verschiedenen Speicher Bereiche der JVM</li>
	<li>Vollständige Log4j Konfiguration sowie jede Menge Details zum Logging</li>
	<li>uvm.</li>
</ul>

<p>MBeans stellen Attribute und Operationen zur Verfügung. Ein Attribut repräsentiert einen Wert und eine Operation führt eine Methode aus. Es gibt verschiedene MBeans:</p>

<ul>
	<li>Standard MBean</li>
	<li>Dynamic MBean</li>
	<li>Model MBean</li>
	<li>Open MBean</li>
</ul>

<p>Im Folgenden werden Standard MBeans und Dynamic MBeans genauer beschrieben.</p>

<h3>Standard MBeans</h3>

<p>Standard MBeans sind eine einfach Möglichkeit schnell Daten bereitzustellen. Hierzu werden eine Klasse und ein dazugehöriges Interface benötigt. Der Names des Interfaces muss aus dem Klassennamen und einem "MBean" dahinter bestehen. Alle öffentlichen Methoden des Interfaces, die mit einem "get" oder "is" beginnen, werden den Attributen des MBeans zugeordnet. Methoden mit einem "set" als Prefix ermöglichen einen Schreibzugriff auf das jeweilige Attribut. Alle weiteren Methoden bilden die Menge der Operationen des MBeans. Die Zuordnung funktioniert über Java Reflections.</p>

<table border="0" class="tlDocTable" style="width:1014.78px">
	<thead>
		<tr>
			<th scope="col"> </th>
			<th scope="col">Prefix</th>
			<th scope="col" style="width:806px">Beschreibung</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>Attribut</td>
			<td>get</td>
			<td style="width:806px">Getter für einen Wert ermöglicht einen Lesezugriff.</td>
		</tr>
		<tr>
			<td> </td>
			<td>is</td>
			<td style="width:806px">Getter mit einem Boolean als Rückgabe-Typ ermöglicht einen Lesezugriff.</td>
		</tr>
		<tr>
			<td> </td>
			<td>set</td>
			<td style="width:806px">Setter für einen Wert ermöglicht einen Schreibzugriff.</td>
		</tr>
		<tr>
			<td>Operation</td>
			<td>-/-</td>
			<td style="width:806px">Eine Methode, die im Java-Code ausgeführt werden soll.</td>
		</tr>
	</tbody>
</table>

<p><em>Tabelle 1: Zusammenfassung der Prefixe der öffentlichen Methoden, die zu ihrer jeweiligen Zuordnung in die Kategorien Attribut oder Operation führen.</em></p>

<h3>Dynamic MBeans</h3>

<p>Um einfacher verstehen zu können, wofür eine bestimmte MBean, ihre Attribute und ihre Operationen stehen, können die Beschreibungstexte (engl. description) angepasst werden. Hierzu werden sogenannte Dynamic MBeans benötigt. Um diese erstellen zu können, muss die MBean-Klasse statt des eigenen Interfaces das Interface DynamicMBean implementieren und die Methoden aus <em>Tabelle 2</em> überschreiben.</p>

<table border="0" class="tlDocTable" style="width:1017.78px">
	<thead>
		<tr>
			<th scope="col">Modifier and type</th>
			<th scope="col" style="width:842px">Method and description</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>AttributeList</td>
			<td style="width:842px">
			<p>getAttributes(String[] attributes)</p>

			<p>Gibt die Werte mehrerer Attribute des Dynamic MBean zurück.</p>
			</td>
		</tr>
		<tr>
			<td>AttributeList</td>
			<td style="width:842px">
			<p>setAttributes(AttributeList attributes)</p>

			<p>Legt die Werte mehrerer Attribute des Dynamic MBean fest.</p>
			</td>
		</tr>
		<tr>
			<td>void</td>
			<td style="width:842px">
			<p>setAttribute(Attribute attribute)</p>

			<p>Legt den Wert eines bestimmten Attributs des Dynamic MBeans fest.</p>
			</td>
		</tr>
		<tr>
			<td>Object</td>
			<td style="width:842px">
			<p>invoke(String actionName, Object[] params, String[] signature)</p>

			<p>Ermöglicht das Aufrufen einer Aktion für das Dynamic MBean.</p>
			</td>
		</tr>
		<tr>
			<td>MBeanInfo</td>
			<td style="width:842px">
			<p>getMBeanInfo()</p>

			<p>Stellt die sichtbaren Attribute und Aktionen des Dynamic MBean mithilfe eines MBeanInfo-Objekts bereit.</p>
			</td>
		</tr>
	</tbody>
</table>

<p><em>Tabelle 2: Interface des Dynamic MBean.</em></p>

<p><strong>MBean Server</strong></p>

<p>An einem MBean Server können MBeans registriert werden.</p>

<pre>
<code class="language-java">MBeanServer mbs = ManagementFactory.getPlatformMBeanServer();
Object mBean = new Foo();
ObjectName mBeanName = new ObjectName("domain:key=property");
mbs.registerMBean(mBean, mBeanName);</code></pre>

<p><em>Codebeispiel 1: Registrierung einer MBean am MBean Server.</em></p>

<p><strong>Wichtig:</strong> Jeder Name eines MBeans darf nur einmal vorkommen!</p>

<hr />
<p><sup>1</sup> <a href="https://www.oracle.com/technical-resources/articles/javase/jmx.html">Oracle</a></p>
